#!/bin/bash

if [ "$#" -lt 5 -o "$#" -gt 6 ]; then
	echo "Usage: $0 <name> <group> <title> <warn> <alert> [<note>]" 1>&2
	exit 1
fi
name="$1"
group="$2"
title="$3"
warn="$4"
alert="$5"
note="$6"

# Encode things that need it.
group=`echo "$group" | sed -e 's/%/%p/g' -e 's/ /%s/g'`
title=`echo "$title" | sed -e 's/%/%p/g' -e 's/ /%s/g'`
note=`echo "$note" | sed -e 's/%/%p/g' -e 's/ /%s/g'`

[ "$note" != '' ] && note=" note=$note"

# Make a simple update.
echo "V2 group=$group host=`uname -n` title=$title stamp=`date +%s` warning=$warn alert=$alert$note" | "$0-bulk" "$name"
