#!/bin/bash

date=`date --date "today" +%Y-%m-%d`

case "$1" in
generate)
    (cd "$HOME/cve-autotriage/cve-tracker" &&
        "$HOME/kteam-tools/cve-tools/kpi/kpi-cve-extract" "$date") >cve-info.json.new
    mv cve-info.json.new cve-info.json
    ;;
timestamp)
    "$HOME/kteam-tools/cve-tools/kpi/kpi-cve-graph-extract" cve-info.json >cve-info.txt.new
    mv cve-info.txt.new cve-info.txt
    ;;
weekly)
    #cp cve-info.json "historical/data/$date.json"
    (cd historical/data && mkdir -p new && "$HOME/kteam-tools/cve-tools/kpi/kpi-cve-graph-all" NEW)
    mv historical/data/NEW/* historical
    ;;
esac
