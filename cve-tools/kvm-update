#!/bin/bash

here=`dirname $0`
case "$here" in
/*) ;;
*)  here="`pwd`/$here" ;;
esac

# Make sure we are only run once ...

[ "$1" != "--locked" ] && exec flock -xn "$HOME/logs/.lock-kvm-update" "$0" --locked "$@"

grab()
{
	local file="$1"
	local url="$2"

	curl -s -o "$file.new" -z "$file" "$url"
	[ -f "$file.new" ] && mv "$file.new" "$file"
}

grab "$HOME/public_html/info/kernel-version-map.txt" "https://kernel.ubuntu.com/~kernel-ppa/info/kernel-version-map.txt"
grab "$HOME/public_html/info/kernel-version-map.html" "https://kernel.ubuntu.com/~kernel-ppa/info/kernel-version-map.html"
