#!/usr/bin/python3

import sys


def key_delta(entry):
    key = entry.split()[0]
    return key[1:] + key[0]


def dump(filename, delta):
    if len(delta) == 0:
        return

    need_filename = True

    delta = sorted(delta, key=key_delta)
    for (plus, minus) in zip(delta[0::2], delta[1::2]):
        minus_bits = minus.split(None, 2)
        plus_bits = plus.split(None, 2)

        if minus_bits[0][1:] != plus_bits[0][1:]:
            print("BROKEN", minus_bits[0], plus_bits[0])
            continue

        #print(minus_bits, plus_bits)
        if (len(minus_bits) > 1 and len(plus_bits) > 1 and
            minus_bits[1] in ('released', 'not-affected') and
            plus_bits[1] in ('released', 'pending', 'needed')
           ):
            if need_filename:
                need_filename = False
                print(filename)
            print(minus)
            print(plus)


delta = []
filename = None
for line in sys.stdin:
    line = line.strip()

    if line[0:4] == '+++ ':
        if filename == None:
            filename = line.split()[1]
        delta = []

    elif line[0:4] == '--- ':
        if line.endswith('1970-01-01 00:00:00 +0000'):
            filename = False
        else:
            filename = None
        #print(filename, line)
        pass

    elif line == '':
        if filename != False and filename not in ('check-cves.log', 'ignored/not-for-us.txt'):
            dump(filename, delta)
        delta = []

    elif line[0] in ('+', '-'):
        delta.append(line)

dump(filename, delta)
